import{d as q,u as A,c as w,r as d,a as E,b as f,e as S,w as c,f as a,g as p,_ as L,h as g,F as x,i as U,o as n,j as s,k as F,v as I,t as Q,l as R,m as i,n as j,M as z,q as H,p as G,s as J,x as C,y as N,z as K,A as O}from"./index-B2yev03a.js";import{A as k}from"./AppTile-BycuUR1q.js";import{t as W,_ as X,d as Y}from"./PostTile.vue_vue_type_script_setup_true_lang-DV2jephg.js";import{L as Z}from"./Loading-DFgC3aiS.js";import{g as P,_ as ee,a as te,b as ae}from"./query-y6O2yjs3.js";const se={class:"form-group"},oe=s("label",{for:"subviewName"},"Subview name",-1),re={key:0,class:"form-text text-danger"},ne=s("button",{class:"btn btn-primary mt-2",type:"submit"},"Continue",-1),ue=s("h1",null,"No Posts",-1),ie=s("p",null,"No posts found.",-1),we=q({__name:"Home",setup(le){const v=A(),_=w(()=>v.value?new z("#subviewModal"):null),o=d(),l=d(),b=d(!0),h=d(P("","New","Post title only",null)),$=(r,t,e)=>{h.value=P(r,t,e,null)},{data:u,promise:D,error:de}=E(w(()=>H(G,...h.value)));D.value.then(()=>b.value=!1);const M=async()=>{var r;if(!(!v.value||!i.id)){if(!o.value||o.value.trim().length===0){l.value="Subview name required.";return}try{if((await J(C(N,o.value))).exists()){l.value="Subview name already exists. Choose another name.";return}await K(C(N,o.value),{author:i.id,uid:i.uid,created:Y(new Date),subscriptions:[i.id],members:1}),(r=_.value)==null||r.hide(),O.push({path:`/v/${o.value}`})}catch(t){console.error(t),l.value="Something went wrong. Please try again later."}}},y=d(1),T=r=>y.value=r,V=w(()=>u.value?ae(u.value,y.value):[]);return(r,t)=>(n(),f(x,null,[S(k,null,{default:c(()=>[S(ee,{pages:a(te)(a(u)),onSearch:t[1]||(t[1]=(e,m,B)=>$(e,m,B)),onSetPage:t[2]||(t[2]=e=>T(e))},{default:c(()=>[s("button",{class:"btn btn-primary w-100",onClick:t[0]||(t[0]=e=>{var m;return(m=_.value)==null?void 0:m.show()})},"Create Subview")]),_:1},8,["pages"])]),_:1}),a(v)?(n(),p(L,{key:0,id:"subviewModal",title:"Create Subview"},{default:c(()=>[s("form",{onSubmit:R(M,["prevent"]),novalidate:""},[s("div",se,[oe,F(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>o.value=e),class:"form-control",id:"subviewName",name:"subviewName",placeholder:"Subview name"},null,512),[[I,o.value]]),l.value?(n(),f("small",re,Q(l.value),1)):g("",!0)]),ne],32)]),_:1})):g("",!0),b.value?(n(),p(Z,{key:1})):!b.value&&!a(u).length?(n(),p(k,{key:2},{default:c(()=>[ue,ie]),_:1})):a(u)&&a(u).length?(n(!0),f(x,{key:3},U(V.value,e=>(n(),p(X,{postId:e.id,subview:`${e.subview}`,title:`${e.title}`,date:a(W)(e.created)||new Date,author:`${e.author}`,body:`${e.content}`,score:e.score||0,vote:a(v)&&a(i).id?a(j)(e.up||[],e.down||[],a(i).id):null},null,8,["postId","subview","title","date","author","body","score","vote"]))),256)):g("",!0)],64))}});export{we as default};
